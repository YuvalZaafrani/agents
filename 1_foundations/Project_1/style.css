/* =========================
   HARD OVERRIDE for GRADIO v4
   ========================= */

/* ---- Palette ---- */
:root {
  --page-bg: #efe4c4;   /* page background (lighter) */
  --panel-bg: #ddcfaf;  /* chat + about + input shell */
  --text:    #000000;   /* black text */

  --green:       #0d4129;  /* buttons, labels, checkbox tick */
  --green-hover: #0b3924;
  --title-green: #2e7c58;  /* page title */

  /* Map to Gradio tokens so theme can't override */
  --body-background-fill: var(--page-bg);
  --background-fill-primary: var(--page-bg);
  --body-text-color: var(--text);
  --panel-background-fill: var(--panel-bg);
  --block-background-fill: var(--panel-bg);

  --button-primary-background-fill: var(--green);
  --button-primary-text-color: #fff;
  --button-secondary-background-fill: var(--green);
  --button-secondary-background-fill-hover: var(--green-hover);
  --button-secondary-text-color: #fff;

  --link-text-color: var(--green);
  --link-text-color-hover: var(--green-hover);
}

/* Force also in dark/system themes */
:host, :host(.dark), body.dark {
  --body-background-fill: var(--page-bg) !important;
  --background-fill-primary: var(--page-bg) !important;
  --body-text-color: var(--text) !important;
  --panel-background-fill: var(--panel-bg) !important;
  --block-background-fill: var(--panel-bg) !important;
}

/* ---- Canvas base ---- */
html, body, .gradio-container, :host, :host(.dark) {
  background: var(--page-bg) !important;
  color: var(--text) !important;
  background-image: none !important;
}

/* Remove raised/striped panels so our colors show */
.gradio-container .gr-box,
.gradio-container .gr-panel,
.gradio-container .gr-group {
  background: transparent !important;
  box-shadow: none !important;
  border: none !important;
}

/* =========================
   Title
   ========================= */
.contain { max-width: 1700px !important; }
.page-title,
.gradio-container h1,
.gradio-container .prose h1 {
  color: var(--title-green) !important;  /* #2e7c58 */
  text-align: center !important;        /* Center main title */
}

/* =========================
   Labels / “pills” (Chat / Name / Email / About me)
   ========================= */
.gradio-container [data-testid="block-label"],
.gradio-container .label,
.gradio-container .block-label {
  background: var(--green) !important;     /* #0d4129 */
  color: #a0a428 !important;
  border: 1px solid var(--green) !important;
  border-radius: 10px !important;
  padding: 3px 10px !important;
}

/* =========================
   Buttons (Send / Clear / Send contact וכו')
   ========================= */
button, .gradio-button, .gr-button {
  background: var(--green) !important;     /* ALWAYS green */
  color: #fff !important;
  border: 1px solid var(--green) !important;
  border-radius: 6px !important;
  transition: transform .06s ease, filter .15s ease, box-shadow .15s ease, background-color .15s ease;
}
button:hover, .gradio-button:hover, .gr-button:hover {
  background: var(--green-hover) !important;
}
/* Pressed/active feedback */
button:active, .gradio-button:active, .gr-button:active {
  transform: translateY(1px) scale(0.99);
  filter: brightness(.92);
  box-shadow: inset 0 2px 4px rgba(0,0,0,.2) !important;
}

/* Right control column (small buttons) */
.control-col {
  width: 90px !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 3px !important;
}
.control-col button {
  height: 22px !important;
  line-height: 22px !important;
  padding: 0 8px !important;
  font-size: 10px !important;
}

/* Checkbox (Use KB) – make the tick green and visible */
.gradio-container input[type="checkbox"] {
  appearance: auto !important;
  accent-color: var(--green) !important;
  width: 14px !important;
  height: 14px !important;
  border: 1px solid var(--green) !important;
}

/* =========================
   CHAT background
   ========================= */
/* Prefer elem_id="chatArea"; otherwise fallback to component classes */
#chatArea, #chatArea * {
  background: var(--panel-bg) !important;  /* #ddcfaf */
  color: var(--text) !important;
}
.gradio-container .gr-chatbot,
.gradio-container .gr-chatbot * {
  background: var(--panel-bg) !important;
  color: var(--text) !important;
  background-image: none !important;
  border-radius: 12px !important;
}

/* =========================
   Input shell (textbox + row)
   ========================= */
.input-shell {
  background: var(--panel-bg) !important;
  border: 1px solid rgba(13,65,41,.4) !important;
  border-radius: 12px !important;
  padding: 8px !important;
}
/* Ensure any wrappers inside the input area don't render dark strips */
.input-shell *,
.input-shell .gr-row,
.input-shell .gr-column,
.input-shell .gr-group,
.input-shell .gr-block,
.input-shell .wrap,
.input-shell .container,
.input-shell .prose,
.input-shell .form {
  background: var(--panel-bg) !important;
}
.input-row { align-items: center !important; gap: 8px !important; }
.col-grow { flex: 1 1 auto !important; min-width: 0 !important; }
.col-auto { flex: 0 0 auto !important; }

.input-shell .gr-textbox .wrap { margin: 0 !important; }
.input-shell textarea,
.input-shell input[type="text"] {
  height: 36px !important;
  padding: 8px 10px !important;
  border-radius: 10px !important;
  background: var(--page-bg) !important;   /* Inputs match browser/page bg */
  color: var(--text) !important;
  border: 1px solid rgba(13,65,41,.4) !important;
  /* Hide deploy-only scrollbars that flash on first render */
  overflow: hidden !important;         /* no scrollbars */
  resize: none !important;             /* user cannot resize single-line */
  scrollbar-width: none !important;    /* Firefox */
}

/* Hide webkit scrollbars explicitly (Gradio deploy sometimes wraps inputs) */
.input-shell textarea::-webkit-scrollbar,
.input-shell input[type="text"]::-webkit-scrollbar,
.card .gr-textbox textarea::-webkit-scrollbar,
.card input[type="text"]::-webkit-scrollbar,
.card input[type="email"]::-webkit-scrollbar {
  width: 0 !important;
  height: 0 !important;
}

/* Ensure single-line behavior for the main user message input as well */
.input-shell .gr-textbox textarea {
  white-space: nowrap !important;
  text-overflow: ellipsis !important;
}

/* Make sure buttons inside input-shell stay green (override any wildcard bg) */
.input-shell .control-col button {
  background: var(--green) !important;
  color: #fff !important;
  border-color: var(--green) !important;
}

/* =========================
   Sidebar (About + Contact)
   ========================= */
/* Raise the whole right column */
.sidebar {
  position: sticky !important;
  top: 0 !important;
  transform: translateY(0px) !important;  /* align About with chat top */
  z-index: 3 !important;
  align-self: flex-start;
  flex: 0 0 300px !important;
  max-width: 300px !important;
  background: var(--panel-bg) !important;   /* make the gaps the same beige */
  border-radius: 12px !important;
}

/* ABOUT ME block (prefer elem_id="aboutCard") */
#aboutCard, #aboutCard *,
.sidebar .gr-markdown, .sidebar .gr-markdown *,
.sidebar .gr-prose, .sidebar .gr-prose * {
  background: var(--panel-bg) !important;   /* #ddcfaf */
  color: var(--text) !important;
  background-image: none !important;
  border: none !important;
  border-radius: 12px !important;
  padding: 0 !important;
}

/* Make subheadings green like buttons (About me / Contact me) */
.sidebar h3,
.sidebar .gr-markdown h3,
.sidebar .gr-prose h3 {
  color: var(--green) !important;
  background: var(--panel-bg) !important;  /* avoid dark header strips */
}

/* Inside the Contact card, override header background to match the card */
.card h3,
.card .gr-markdown h3,
.card .gr-prose h3 {
  background: #538b71 !important;
}

/* Ensure the whole scrollable sidebar area and gaps use chat background */
.sidebar-scroll,
.sidebar-scroll * {
  background: var(--panel-bg) !important;
}

/* Contact card + inputs */
.card, .card * {
  background: #538b71 !important;        /* Contact card background */
  color: var(--text) !important;
}
.card {
  border: 1px solid rgba(13,65,41,.4) !important;
  border-radius: 12px !important;
  padding: 10px !important;
  margin-top: 10px !important;
}
.card .gr-button,
.card button {
  background: var(--green) !important;    /* Make Send contact green by default */
  color: #fff !important;
  border-color: var(--green) !important;
}

/* Force single-line inputs in the Contact card and hide any scrollbars */
.card .gr-textbox textarea {
  height: 36px !important;
  line-height: 1.3 !important;
  padding: 8px 10px !important;

  /* kill scrollbars everywhere */
  overflow: hidden !important;
  resize: none !important;
  white-space: nowrap !important;
  text-overflow: ellipsis !important;
  scrollbar-width: none !important;            /* Firefox */
}
.card .gr-textbox textarea::-webkit-scrollbar { /* Chrome/Safari/Edge */
  width: 0 !important;
  height: 0 !important;
}

/* Keep input and textarea same height (single-line look) */
.card .gr-text-input input {
  height: 36px !important;
  line-height: 1.3 !important;
  padding: 8px 10px !important;

  /* safety – no scroll or special appearances */
  overflow: hidden !important;
  white-space: nowrap !important;
  text-overflow: ellipsis !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
}

/* Plane animation while Send contact is disabled (during sending) */
.card .gr-button { position: relative !important; }
.card .gr-button[disabled]::after {
  content: "✈️";
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  animation: plane-fly 1.1s ease-in-out infinite;
  opacity: .95;
}
@keyframes plane-fly {
  0%   { transform: translateY(-50%) translateX(-6px); }
  50%  { transform: translateY(-50%) translateX(6px); }
  100% { transform: translateY(-50%) translateX(-6px); }
}
.card .gr-text-input input,
.card .gr-textbox textarea {
  background: var(--page-bg) !important;    /* Inputs (Name/Email) match page bg */
  color: var(--text) !important;
  border: 1px solid rgba(13,65,41,.4) !important;
}

/* Stronger override for Gradio's input elements in Contact card */
.card input[type="text"],
.card input[type="email"],
.card textarea {
  background: var(--page-bg) !important;    /* #efe4c4 */
  color: var(--text) !important;
}
.card input::placeholder,
.card textarea::placeholder {
  color: rgba(0,0,0,.6) !important;
}

/* Ensure ALL text in app defaults to black unless explicitly overridden */
.gradio-container, .gradio-container * {
  --body-text-color: var(--text) !important;
  color: var(--text) !important;
}

/* =========================
   User chat bubble (override Gradio v4)
   ========================= */
:root {
  --user-bubble-bg: #538b71;   /* medium green to match sidebar card */
  --user-bubble-text: #000000; /* black text as requested */
}

/* Target common Gradio v4 selectors for user messages (scoped to #chatArea to beat #chatArea * rule) */
#chatArea .message.user,
#chatArea .message[data-testid="user"],
#chatArea .chat-message.user,
#chatArea .message.role-user,
#chatArea [data-testid="user"],
#chatArea [data-role="user"],
#chatArea [role="user"],
#chatArea [data-testid="user"] .message,
#chatArea [data-role="user"] .message {
  background: var(--user-bubble-bg) !important;
  color: var(--user-bubble-text) !important;
  border: 1px solid rgba(255,255,255,.15) !important;
}

/* Ensure inner text remains visible (paragraphs, links, inline elements) */
#chatArea .message.user *,
#chatArea .message[data-testid="user"] *,
#chatArea [data-testid="user"] .message *,
#chatArea [data-role="user"] .message * {
  color: var(--user-bubble-text) !important;
  background: transparent !important; /* remove beige chips behind text */
  border: none !important;            /* remove inner frames around text */
  outline: none !important;
  box-shadow: none !important;
}

/* Links inside the user bubble */
#chatArea .message.user a,
#chatArea .message[data-testid="user"] a,
#chatArea [data-testid="user"] .message a,
#chatArea [data-role="user"] .message a {
  color: #000000 !important;
  text-decoration: underline;
}

/* Code blocks inside the user bubble */
#chatArea .message.user pre,
#chatArea .message.user code,
#chatArea .message[data-testid="user"] pre,
#chatArea .message[data-testid="user"] code,
#chatArea [data-testid="user"] .message pre,
#chatArea [data-role="user"] .message pre,
#chatArea [data-testid="user"] .message code,
#chatArea [data-role="user"] .message code {
  background: rgba(255,255,255,.65) !important;
  color: #000000 !important;
}

/* Make sure text stays legible even over images or patterned content */
#chatArea .message.user,
#chatArea .message[data-testid="user"],
#chatArea [data-testid="user"] .message,
#chatArea [data-role="user"] .message {
  mix-blend-mode: normal !important;
  text-shadow: 0 1px 0 rgba(0,0,0,.12);
}

/* --- Single-line inputs polish & cross-browser hardening --- */
.card .gr-textbox textarea,
.card .gr-text-input input {
  /* no scrollbars anywhere */
  overflow: hidden !important;
  resize: none !important;
  white-space: nowrap !important;
  text-overflow: ellipsis !important;

  /* iOS/Safari/Edge quirks */
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
  box-shadow: none !important;
}

/* Hide webkit scrollbars (fallback if overflow toggles) */
.card .gr-textbox textarea::-webkit-scrollbar,
.card .gr-text-input input::-webkit-scrollbar {
  width: 0 !important;
  height: 0 !important;
}

/* Placeholder color */
.card .gr-textbox textarea::placeholder,
.card .gr-text-input input::placeholder {
  color: rgba(11, 31, 22, 0.6) !important;
}

/* Focus state */
.card .gr-textbox textarea:focus,
.card .gr-text-input input:focus {
  outline: none !important;
  border-color: #0e7a4a !important;                 /* ירוק כהה */
  box-shadow: 0 0 0 2px rgba(29, 185, 84, 0.15) !important; /* הילה ירקרקה */
}
